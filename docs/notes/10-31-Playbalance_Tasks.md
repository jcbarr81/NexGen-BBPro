# Playbalance Tuning Tasks — 2025-10-31

Tracked priorities coming out of the latest full-season sim and batter diagnostics.

- **Priority 1 – Restore contact throughput**  
  Adjust the contact limiter stack so league K% and pitches/PA move back toward MLB ranges. Raise `contactFactorBase`, pull `contactFactorDiv` down, and cut `missChanceScale`/lift `contactOutcomeScale` in `playbalance/sim_config.py:446` and `:462`, then confirm the resulting swing-contact math in `playbalance/batter_ai.py:603`.

- **Priority 2 – Ease 2-1/2-2 discipline penalties**  
  Reduce the extra take bias on leverage counts by loosening the overrides in `playbalance/sim_config.py:278`–`:318` (raw scales, rating offsets, penalty multipliers, chase chance) so called-strike gaps shrink and strikeouts normalize.

- **Priority 3 – Rebalance pitcher objectives on hitter counts**  
  Make pitcher intent less zone-heavy when behind by softening the negative zone biases and nudging waste bias up in `playbalance/sim_config.py:428`–`:435`, targeting MLB-level ball rates without reopening early-count aggression.

- **Priority 4 – Rein in steal spam**  
  Tone down baserunning aggression and restore realistic speed adjustments around `playbalance/sim_config.py:164` so steal attempts fall and success percentage climbs toward ~75%.

- **Priority 5 – Reset diagnostics after each pass**  
  After any tuning update, rerun `scripts/collect_batter_decisions.py` and a full-season sim to verify P/PA, BB%, K%, HR/PA, SB%, and starter workloads are converging before moving on.

## Iteration — post-discipline/foul tuning sweep (2025-11-06)

- Ran `scripts/collect_batter_decisions.py` (200-game stochastic) after the latest config patch. Outputs now sit at swing `29.5%`, take `70.5%`, contact `23.97%`, foul `6.71%`, BIP `10.48%`, ball `36.4%`, called-strike `33.3%`, walk `2.1%`, strikeout `11.3%`. Deterministic trace (10 games) echoed the same mix (`28.4%` swing / `71.6%` take / `6.24%` foul / `10.41%` BIP).
- Full-season sim (`scripts/simulate_season.py --disable-tqdm --seed 2025`) still diverges sharply: runs `3.04` (MLB `8.94`), HR `1.22` (vs `2.33`), BB `4.73` (vs `6.35`), K `20.65` (vs `17.11`), SB `5.56` on success gap, and Pitches/PA collapses to `1.58` with BABIP `0.224`. Two-strike counts (`30,285`) and three-ball counts (`8,315`) confirm the pace/strikeout imbalance persists even with the foul redistribution.
- Next adjustments need to chase: reinstate realistic pitch counts (review calibration disables, pitch objective clamps, and swingProbScale), push HR/run environment back up, and revisit steal gating after strikeout/pitch volume is stable.

## Iteration — contact redistribution & steal clamp (2025-11-07)

- Rebalanced swing scaling and foul shares (higher zone swing floor, `foulPitchBasePct=16`, `foulProbabilityScale=0.96`, `ballInPlayScale=0.11`) and raised contact/ID support to keep Ks in check while trimming chase contact floors. Steal attempt scaling now gates below `~72%` success odds and success uplift trimmed to `+0.018`.
- Updated diagnostics: `scripts/collect_batter_decisions.py` (200-game stochastic) now reports swing `45.1%`, take `54.9%`, contact `31.1%`, foul `9.3%`, BIP `15.5%`, ball `28.1%`, called strike `26.2%`, walk `0.83%`, strikeout `11.6%`. Deterministic pass (10 games) mirrors the profile (swing `46.5%`, foul `10.3%`, BIP `16.8%`, walk `0.83%`, K `11.5%`).
- Season sim (`scripts/simulate_season.py --disable-tqdm --seed 2025`) moves Ks closer to MLB (Sim `16.2` vs `17.1`) and raises hits to `16.6`, but offense remains suppressed (runs `4.19`, HR `1.66`, BB `1.82`) and steals are still high at `4.25`/`0.83`. Reported `Pitches/PA=1.28` reflects only “real” pitches in box scores—the injected calibration pitches increment `balls/strikes` but not `pitches`, so additional instrumentation is needed before trusting that metric. Next pass should focus on restoring walk and HR rates (raise swing-ball discipline penalties, boost contact outcome/launch) and ensure steal aggression responds with the new baselines.
- Follow-up adjustments (discipline floors/multipliers, swing scaling floors, contact outcome uplift, steal gates tightened) lifted stochastic swing/take to `39.4%`/`60.6%` with balls at `31.0%` and walks at `1.0%` (`collect_batter_decisions.py`, deterministic: swing `39.0%`, walk `1.3%`). Full-season sim now lands at Ks `16.3`, hits `16.1`, but walks/HR remain light (`1.87` BB, `1.61` HR) and steals stay elevated (`4.03` / `0.90`). `targetPitchesPerPA` is cleared so injected pitches stop accumulating, yet the box-score pitch total still omits the calibrator inserts—need to reconcile the stat pipeline while nudging zone/o-zone scales to recover BB/HR without reopening chase swings.
- Additional walk-focused tuning (OOZ swing clamps, count penalties, three-ball chase odds) nudged stochastic ball rate to `31.2%` with walks at `1.04%` (deterministic `1.03%`). Season sim edges walks up to `2.06` per game (from `1.82` baseline) but still trails MLB (`6.35`); the more severe chase reductions are now suppressing HR/run output (`1.46` HR, `3.67` runs) while steals remain high (`4.33` / `0.92`), so next pass needs to layer in pitcher zone bias tweaks or count-specific penalties that preserve late-count aggression while keeping chase odds muted.
- Pivoted to pitcher intent: reduced attack bias across hitter counts and tightened OOZ swing scaling. Three-ball chase odds fell to `8%`, early-count takes eased slightly, and season walks crept to `2.26` per game (stochastic walk rate `1.11%`, deterministic `1.38%`). Runs/HR remain flat (`3.78` / `1.50`) and steal volume is unchanged (`4.35` / `0.96`); to gain further walk headroom we likely need to press pitcher waste bias harder or inject per-count control variance while restoring some damage output so the added balls translate into run production rather than just called strikes.
- Fresh waste-heavy objectives (attack trimmed to ~48% on 0-0, 24% on 2-0, 10% on 3-0) nudged the 81-game sample to runs `4.05`, HR `1.56`, walks `2.52`, Ks `16.9`, SB `4.38`, P/PA `1.36`, BABIP `0.238`. Walks are trending up but still miles from MLB `6.35`; the added waste is lowering strikeout pressure and raising hits without spiking offense, so next steps are likely pitcher control randomness or per-count ball incentives combined with restoring ball-in-play damage (HR/BABIP) to convert those extra balls into run value rather than single-heavy rallies.
- Walk midpoint reset (`swingBallDisciplineWeight=0.20`, moderate waste bias) keeps diagnostics stable with stochastic walk rate `1.16%` and an 81-game run of `Runs 4.06` / `BB 2.00`. Current half-step (`weight=0.24`, auto-take `3.84/0.61/1.48`, chase `0.28`) still leaves the 81-game sample at `BB ~2.0`, even as Ks fall (`14.7`) and HR slide (`1.31`). We need a larger lever—next passes will continue dropping pitcher attack bias and league strike% in bigger chunks, paired with tighter batter penalties, until the 81-game walk rate climbs appreciably.
